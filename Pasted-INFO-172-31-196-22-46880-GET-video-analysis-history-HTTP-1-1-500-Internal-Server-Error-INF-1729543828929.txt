INFO:     172.31.196.22:46880 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:     172.31.196.22:38256 - "GET / HTTP/1.1" 200 OK
INFO:     172.31.196.22:38256 - "GET /auth_status HTTP/1.1" 200 OK
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/user_chat_history?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=50 "HTTP/1.1 400 Bad Request"
ERROR:app:Unexpected error in chat_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column user_chat_history.timestamp does not exist'}
ERROR:app:Traceback (most recent call last):
  File "/home/runner/GeminiVideoBot/app.py", line 189, in chat_history
    history = get_chat_history(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/GeminiVideoBot/database.py", line 75, in get_chat_history
    response = supabase.table("user_chat_history").select("*").eq("user_id", str(user_id)).order("timestamp", desc=True).limit(limit).execute()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/GeminiVideoBot/.pythonlibs/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", line 70, in execute
    raise APIError(r.json())
postgrest.exceptions.APIError: {'code': '42703', 'details': None, 'hint': None, 'message': 'column user_chat_history.timestamp does not exist'}

ERROR:app:Error occurred after 1.02 seconds
INFO:     172.31.196.22:38256 - "GET /chat_history HTTP/1.1" 500 Internal Server Error
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:33900 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:     172.31.196.22:38522 - "POST /logout HTTP/1.1" 200 OK
INFO:     172.31.196.22:38522 - "GET /login HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://xghbfotsivdbuqvumyyu.supabase.co/auth/v1/token?grant_type=password "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/users?select=%2A&email=eq.wicked%40gmail.com "HTTP/1.1 200 OK"
INFO:     172.31.196.22:60092 - "POST /login HTTP/1.1" 200 OK
INFO:     172.31.196.22:60092 - "GET / HTTP/1.1" 200 OK
INFO:     172.31.196.22:60092 - "GET /auth_status HTTP/1.1" 200 OK
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/user_chat_history?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=50 "HTTP/1.1 400 Bad Request"
ERROR:app:Unexpected error in chat_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column user_chat_history.timestamp does not exist'}
ERROR:app:Traceback (most recent call last):
  File "/home/runner/GeminiVideoBot/app.py", line 189, in chat_history
    history = get_chat_history(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/GeminiVideoBot/database.py", line 75, in get_chat_history
    response = supabase.table("user_chat_history").select("*").eq("user_id", str(user_id)).order("timestamp", desc=True).limit(limit).execute()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/GeminiVideoBot/.pythonlibs/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", line 70, in execute
    raise APIError(r.json())
postgrest.exceptions.APIError: {'code': '42703', 'details': None, 'hint': None, 'message': 'column user_chat_history.timestamp does not exist'}

ERROR:app:Error occurred after 0.48 seconds
INFO:     172.31.196.22:60092 - "GET /chat_history HTTP/1.1" 500 Internal Server Error
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:60096 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/users?select=id&id=eq.e5fb9299-3a16-4453-9586-2735c521d843 "HTTP/1.1 200 OK"
INFO:     172.31.196.22:56016 - "POST /send_message HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:56016 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:app:Total chat history processing time: 0.21 seconds
INFO:     172.31.196.22:56028 - "GET /chat_history HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/users?select=id&id=eq.e5fb9299-3a16-4453-9586-2735c521d843 "HTTP/1.1 200 OK"
INFO:     172.31.196.22:41762 - "POST /send_message HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:41762 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:app:Total chat history processing time: 0.21 seconds
INFO:     172.31.196.22:41774 - "GET /chat_history HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/users?select=id&id=eq.e5fb9299-3a16-4453-9586-2735c521d843 "HTTP/1.1 200 OK"
INFO:     172.31.196.22:60188 - "POST /send_message HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:60188 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:app:Total chat history processing time: 0.21 seconds
INFO:     172.31.196.22:60802 - "GET /chat_history HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/users?select=id&id=eq.e5fb9299-3a16-4453-9586-2735c521d843 "HTTP/1.1 200 OK"
INFO:     172.31.196.22:53466 - "POST /send_message HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:53466 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:app:Total chat history processing time: 0.21 seconds
INFO:     172.31.196.22:53476 - "GET /chat_history HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/users?select=id&id=eq.e5fb9299-3a16-4453-9586-2735c521d843 "HTTP/1.1 200 OK"
INFO:     172.31.196.22:34894 - "POST /send_message HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/user_chat_history "HTTP/1.1 400 Bad Request"
ERROR:database:Error writing messages to database: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'timestamp' column of 'user_chat_history' in the schema cache"}
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/video_analysis_output?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=10 "HTTP/1.1 400 Bad Request"
ERROR:app:Error in video_analysis_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column video_analysis_output.timestamp does not exist'}
INFO:     172.31.196.22:34894 - "GET /video_analysis_history HTTP/1.1" 500 Internal Server Error
INFO:app:Fetching chat history for user: e5fb9299-3a16-4453-9586-2735c521d843
INFO:httpx:HTTP Request: GET https://xghbfotsivdbuqvumyyu.supabase.co/rest/v1/user_chat_history?select=%2A&user_id=eq.e5fb9299-3a16-4453-9586-2735c521d843&order=timestamp.desc&limit=50 "HTTP/1.1 400 Bad Request"
ERROR:app:Unexpected error in chat_history endpoint: {'code': '42703', 'details': None, 'hint': None, 'message': 'column user_chat_history.timestamp does not exist'}
ERROR:app:Traceback (most recent call last):
  File "/home/runner/GeminiVideoBot/app.py", line 189, in chat_history
    history = get_chat_history(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/GeminiVideoBot/database.py", line 75, in get_chat_history
    response = supabase.table("user_chat_history").select("*").eq("user_id", str(user_id)).order("timestamp", desc=True).limit(limit).execute()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/GeminiVideoBot/.pythonlibs/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", line 70, in execute
    raise APIError(r.json())
postgrest.exceptions.APIError: {'code': '42703', 'details': None, 'hint': None, 'message': 'column user_chat_history.timestamp does not exist'}

ERROR:app:Error occurred after 1.01 seconds
INFO:     172.31.196.22:34902 - "GET /chat_history HTTP/1.1" 500 Internal Server Error